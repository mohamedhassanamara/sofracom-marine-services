module.exports=[7502,a=>{"use strict";var b=a.i(2734);let c=a.i(4747).default.join(process.cwd(),"public","assets","data","products.json"),d=a=>a?a.startsWith("/")?a:`/${a}`:"",e=a=>(a||"").toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-|-$/g,"");function f(){return(JSON.parse(b.default.readFileSync(c,"utf-8")).categories||[]).map(a=>{let b=a.slug||e(a.name);return{...a,slug:b,image:d(a.image),products:Array.isArray(a.products)&&a.products.length?a.products.map(c=>{var f;let g,h,i,j,k,l;return g=(f={...a,slug:b}).slug||e(f.name),h=`${g}-${e(c.title)}`,j=(i=(Array.isArray(c.images)&&c.images.length?c.images:c.image?[c.image]:[]).map(d).filter(Boolean))[0]||d(c.image)||"/logo.jpeg",k=Array.isArray(c.variants)?c.variants.map(a=>({label:a.label||"Variant",price:Number.isFinite(a.price)?a.price:Number(a.price)||0})):[],l=Number.isFinite(c.price)&&c.price>0?c.price:k[0]?.price||0,{...c,id:h,categoryName:f.name,categorySlug:g,image:j,images:i.length?i:[j],datasheet:d(c.datasheet),variants:k,price:l,stock:c.stock||"in",usage:Array.isArray(c.usage)?c.usage:[]}}):[]}})}function g(a){return a&&f().find(b=>b.slug===a)||null}function h(a){if(!a)return null;for(let b of f()){let c=b.products.find(b=>b.id===a);if(c)return{product:c,category:b}}return null}function i(){return f().flatMap(a=>a.products.map(b=>({categorySlug:a.slug,productId:b.id})))}a.s(["getCategories",()=>f,"getCategoryBySlug",()=>g,"getProductById",()=>h,"getProductPaths",()=>i])},8054,a=>{"use strict";var b=a.i(7669);let c=()=>[];function d(){let[a,d]=(0,b.useState)(c);(0,b.useEffect)(()=>{},[a]);let e=(0,b.useMemo)(()=>a.reduce((a,b)=>a+(b.quantity||0),0),[a]),f=(0,b.useMemo)(()=>a.reduce((a,b)=>Number.isFinite(b.price)?a+b.quantity*b.price:a,0),[a]),g=(0,b.useMemo)(()=>a.some(a=>"on-order"===a.stock),[a]);return{cart:a,addItem:a=>{d(b=>b.findIndex(b=>b.id===a.id)>=0?b.map(b=>b.id===a.id?{...b,quantity:b.quantity+a.quantity}:b):[...b,a])},updateQuantity:(a,b)=>{d(c=>c.map(c=>c.id===a?{...c,quantity:Math.max(1,b)}:c).filter(a=>a.quantity>0))},removeItem:a=>{d(b=>b.filter(b=>b.id!==a))},count:e,total:f,resetCart:()=>d([]),hasOnOrderItem:g}}a.s(["default",()=>d])},7398,a=>{"use strict";var b=a.i(9168),c=a.i(7068),d=a.i(2759),e=a.i(3590),f=a.i(7342),g=a.i(8171),h=a.i(1257),i=a.i(7669),j=a.i(8054),k=a.i(7502);let l=new Intl.NumberFormat("fr-TN",{style:"currency",currency:"TND"}),m=a=>Number.isFinite(a)?l.format(a):`${a||0} TND`;async function n(){return{paths:(0,k.getProductPaths)().map(a=>({params:{categorySlug:a.categorySlug,productId:a.productId}})),fallback:!1}}async function o({params:a}){let b=(0,k.getProductById)(a.productId);return b&&b.category.slug===a.categorySlug?{props:{product:b.product,category:b.category}}:{notFound:!0}}function p({product:a,category:b}){let[c,d]=(0,i.useState)(0),[e,f]=(0,i.useState)(0),[k,l]=(0,i.useState)(!1),[n,o]=(0,i.useState)({message:"",type:""}),[p,q]=(0,i.useState)(!1),[r,s]=(0,i.useState)({name:"",phone:"",address:"",notes:""}),{cart:t,addItem:u,updateQuantity:v,removeItem:w,total:x,count:y}=(0,j.default)(),z=a.variants[c]??null,A=z?.price??a.price??0,B=a.images[e]||a.image,C=a=>{let{name:b,value:c}=a.target;s(a=>({...a,[b]:c}))},D=async a=>{if(a.preventDefault(),!t.length)return void o({message:"Cart is empty",type:"error"});if(!r.name||!r.phone||!r.address)return void o({message:"Name, phone, and address are required.",type:"error"});q(!0),o({message:"Sending order…",type:""});let b={customer:r,items:t.map(a=>({id:a.id,title:a.title,price:a.price,quantity:a.quantity,image:a.image,category:a.category,variantLabel:a.variantLabel})),total:x,currency:"TND"};try{let a=await fetch("/api/create-order",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(b)}),c=await a.json();if(!a.ok||!c.ok)throw Error(c.error||"Unable to place order");s({name:"",phone:"",address:"",notes:""}),o({message:"Order submitted! We will confirm shortly.",type:"success"})}catch(a){console.error("[order] submit failed",a),o({message:a.message||"Unable to submit order.",type:"error"})}finally{q(!1)}},E=()=>l(!1),F=a.description||"",[G,H]=(0,i.useState)(!1),I=F.length>320,J=F.slice(0,320);return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)("main",{className:"max-w-6xl mx-auto px-6 py-12",children:[(0,g.jsxs)("div",{className:"flex flex-col gap-4 mb-6",children:[(0,g.jsx)("p",{className:"text-sm text-gray-500 uppercase tracking-wide",children:"Product detail"}),(0,g.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[(0,g.jsx)(h.default,{href:"/products",className:"hover:underline",children:"Catalog"}),(0,g.jsx)("span",{children:"/"}),(0,g.jsx)(h.default,{href:`/products/${b.slug}`,className:"hover:underline",children:b.name}),(0,g.jsx)("span",{children:"/"}),(0,g.jsx)("span",{className:"font-semibold text-gray-700",children:a.title})]})]}),(0,g.jsxs)("div",{className:"grid lg:grid-cols-[1.1fr,0.9fr] gap-10",children:[(0,g.jsxs)("div",{className:"bg-white rounded-3xl shadow-lg border border-gray-100 p-6",children:[(0,g.jsx)("img",{src:B,alt:a.title,className:"w-full h-96 object-contain rounded-2xl bg-gray-50"}),a.images.length>1&&(0,g.jsx)("div",{className:"flex flex-wrap gap-3 mt-4",children:a.images.map((b,c)=>(0,g.jsx)("button",{type:"button",onClick:()=>f(c),className:`w-20 h-20 rounded-2xl border ${e===c?"border-blue-500":"border-gray-200"}`,children:(0,g.jsx)("img",{src:b,alt:`${a.title}-${c}`,className:"w-full h-full object-cover rounded-2xl"})},b))})]}),(0,g.jsxs)("div",{className:"space-y-5",children:[(0,g.jsxs)("div",{children:[(0,g.jsx)("p",{className:"text-xs text-gray-500 uppercase tracking-wide",children:a.categoryName}),(0,g.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:a.title}),(0,g.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:a.brand})]}),(0,g.jsx)("div",{className:"flex flex-wrap gap-2",children:a.usage.map(b=>(0,g.jsx)("span",{className:"tag px-3 py-1 rounded-full text-xs",children:b},`${a.id}-tag-${b}`))}),(0,g.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,g.jsxs)("div",{className:"flex items-center gap-4",children:[(0,g.jsx)("span",{className:"text-4xl font-bold text-gray-900",children:m(A)}),(0,g.jsx)("span",{className:`stock-badge ${"in"===a.stock?"stock-badge--in":"on-order"===a.stock?"stock-badge--order":"stock-badge--out"}`,children:"in"===a.stock?"In stock":"on-order"===a.stock?"On order":"Out of stock"})]}),"on-order"===a.stock&&(0,g.jsx)("p",{className:"text-sm text-orange-400",children:"This item is on order; delivery will take longer."})]}),(0,g.jsx)("div",{className:"flex flex-wrap gap-2",children:a.variants.length?a.variants.map((a,b)=>(0,g.jsxs)("button",{type:"button",className:`detail-variant-btn ${c===b?"active":""}`,onClick:()=>d(b),children:[a.label,(0,g.jsx)("span",{children:m(a.price)})]},`${a.label}-${b}`)):(0,g.jsx)("span",{className:"text-sm text-gray-500",children:"Single configuration"})}),(0,g.jsx)("p",{className:"text-sm text-gray-700 leading-relaxed",children:G?F:`${J}${I?"…":""}`}),I&&(0,g.jsx)("button",{type:"button",className:"text-blue-600 hover:underline text-sm font-semibold",onClick:()=>H(a=>!a),children:G?"Show less":"Read more"}),a.datasheet&&(0,g.jsx)("a",{href:a.datasheet,target:"_blank",rel:"noreferrer",className:"datasheet-link",children:"Download datasheet"}),(0,g.jsx)("button",{type:"button",className:"w-full rounded-2xl bg-blue-600 px-4 py-3 text-sm font-semibold text-white shadow hover:bg-blue-700 transition",onClick:()=>{if("in"!==a.stock)return;let b=z?.price??A,c=z?.label;u({id:c?`${a.id}-${c}`:a.id,title:a.title,price:b,quantity:1,image:a.image,category:a.categoryName,brand:a.brand,variantLabel:c}),l(!0)},disabled:"in"!==a.stock,children:"Add to cart"}),(0,g.jsx)("p",{className:`quote-status ${n.type} mt-2 text-sm ${n.message?"":"hidden"}`,"aria-live":"polite",children:n.message})]})]})]}),(0,g.jsxs)("button",{id:"cartFab",className:"cart-fab",type:"button",onClick:()=>{l(!0),o({message:"",type:""})},children:[(0,g.jsx)("span",{children:"Cart"}),(0,g.jsx)("span",{className:"px-2 py-1 rounded-full bg-white/15 text-sm font-semibold",children:y})]}),(0,g.jsx)("div",{id:"cartOverlay",className:`cart-overlay ${k?"active":""}`,onClick:E}),(0,g.jsxs)("aside",{id:"cartDrawer",className:`cart-drawer ${k?"open":""}`,"aria-hidden":!k,children:[(0,g.jsxs)("div",{className:"cart-header",children:[(0,g.jsxs)("div",{children:[(0,g.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Your order"}),(0,g.jsx)("p",{className:"text-sm text-gray-500",children:"Review items then confirm your details."})]}),(0,g.jsx)("button",{id:"cartClose",type:"button","aria-label":"Close cart",className:"text-2xl leading-none text-gray-500 hover:text-gray-800",onClick:E,children:"×"})]}),(0,g.jsx)("div",{className:"cart-body",id:"cartItems",children:t.length?t.map(a=>(0,g.jsxs)("div",{className:"cart-item","data-id":a.id,children:[(0,g.jsx)("img",{src:a.image,alt:a.title}),(0,g.jsxs)("div",{children:[(0,g.jsx)("p",{className:"cart-item-title",children:a.title}),(0,g.jsx)("p",{className:"text-xs text-gray-500",children:a.variantLabel?a.variantLabel:a.category}),(0,g.jsxs)("div",{className:"cart-qty mt-2",children:[(0,g.jsx)("button",{type:"button",onClick:()=>v(a.id,a.quantity-1),children:"−"}),(0,g.jsx)("input",{type:"number",min:"1",value:a.quantity,onChange:b=>{let c=Number(b.target.value);Number.isFinite(c)&&v(a.id,c)}}),(0,g.jsx)("button",{type:"button",onClick:()=>v(a.id,a.quantity+1),children:"+"}),(0,g.jsx)("button",{type:"button",onClick:()=>w(a.id),className:"text-xs text-red-500 ml-3",children:"Remove"})]})]})]},a.id)):(0,g.jsx)("p",{className:"empty-cart",children:"Your cart is empty."})}),(0,g.jsxs)("div",{className:"cart-summary",children:[(0,g.jsxs)("div",{className:"cart-summary-row",children:[(0,g.jsx)("span",{children:"Total"}),(0,g.jsx)("span",{children:m(x)})]}),(0,g.jsx)("p",{className:`cart-alert ${n.type}`,role:"status",children:n.message})]}),(0,g.jsxs)("form",{id:"checkoutForm",className:"cart-form",onSubmit:D,noValidate:!0,children:[(0,g.jsxs)("label",{children:[(0,g.jsx)("span",{children:"Full name"}),(0,g.jsx)("input",{type:"text",name:"name",value:r.name,onChange:C,required:!0})]}),(0,g.jsxs)("label",{children:[(0,g.jsx)("span",{children:"Phone"}),(0,g.jsx)("input",{type:"tel",name:"phone",value:r.phone,onChange:C,required:!0})]}),(0,g.jsxs)("label",{children:[(0,g.jsx)("span",{children:"Delivery address"}),(0,g.jsx)("textarea",{name:"address",rows:"2",value:r.address,onChange:C,required:!0})]}),(0,g.jsxs)("label",{children:[(0,g.jsx)("span",{children:"Notes (optional)"}),(0,g.jsx)("textarea",{name:"notes",rows:"2",value:r.notes,onChange:C})]}),(0,g.jsx)("button",{id:"cartSubmitBtn",type:"submit",className:"cart-submit",disabled:p,children:p?"Sending…":"Send order"})]})]})]})}a.s(["default",()=>p,"getStaticPaths",()=>n,"getStaticProps",()=>o],3969);var q=a.i(3969),r=a.i(9193);let s=(0,d.hoist)(q,"default"),t=(0,d.hoist)(q,"getStaticProps"),u=(0,d.hoist)(q,"getStaticPaths"),v=(0,d.hoist)(q,"getServerSideProps"),w=(0,d.hoist)(q,"config"),x=(0,d.hoist)(q,"reportWebVitals"),y=(0,d.hoist)(q,"unstable_getStaticProps"),z=(0,d.hoist)(q,"unstable_getStaticPaths"),A=(0,d.hoist)(q,"unstable_getStaticParams"),B=(0,d.hoist)(q,"unstable_getServerProps"),C=(0,d.hoist)(q,"unstable_getServerSideProps"),D=new b.PagesRouteModule({definition:{kind:c.RouteKind.PAGES,page:"/products/[categorySlug]/[productId]",pathname:"/products/[categorySlug]/[productId]",bundlePath:"",filename:""},distDir:".next",relativeProjectDir:"",components:{App:f.default,Document:e.default},userland:q}),E=(0,r.getHandler)({srcPage:"/products/[categorySlug]/[productId]",config:w,userland:q,routeModule:D,getStaticPaths:u,getStaticProps:t,getServerSideProps:v});a.s(["config",0,w,"default",0,s,"getServerSideProps",0,v,"getStaticPaths",0,u,"getStaticProps",0,t,"handler",0,E,"reportWebVitals",0,x,"routeModule",0,D,"unstable_getServerProps",0,B,"unstable_getServerSideProps",0,C,"unstable_getStaticParams",0,A,"unstable_getStaticPaths",0,z,"unstable_getStaticProps",0,y],7398)}];

//# sourceMappingURL=_20379e8a._.js.map