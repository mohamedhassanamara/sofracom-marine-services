module.exports=[7502,a=>{"use strict";var b=a.i(2734);let c=a.i(4747).default.join(process.cwd(),"public","assets","data","products.json"),d=a=>a?a.startsWith("/")?a:`/${a}`:"",e=a=>(a||"").toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-|-$/g,"");function f(){return(JSON.parse(b.default.readFileSync(c,"utf-8")).categories||[]).map(a=>{let b=a.slug||e(a.name);return{...a,slug:b,image:d(a.image),products:Array.isArray(a.products)&&a.products.length?a.products.map(c=>{var f;let g,h,i,j,k,l;return g=(f={...a,slug:b}).slug||e(f.name),h=`${g}-${e(c.title)}`,j=(i=(Array.isArray(c.images)&&c.images.length?c.images:c.image?[c.image]:[]).map(d).filter(Boolean))[0]||d(c.image)||"/logo.jpeg",k=Array.isArray(c.variants)?c.variants.map(a=>({label:a.label||"Variant",price:Number.isFinite(a.price)?a.price:Number(a.price)||0})):[],l=Number.isFinite(c.price)&&c.price>0?c.price:k[0]?.price||0,{...c,id:h,categoryName:f.name,categorySlug:g,image:j,images:i.length?i:[j],datasheet:d(c.datasheet),variants:k,price:l,stock:c.stock||"in",usage:Array.isArray(c.usage)?c.usage:[]}}):[]}})}function g(a){return a&&f().find(b=>b.slug===a)||null}function h(a){if(!a)return null;for(let b of f()){let c=b.products.find(b=>b.id===a);if(c)return{product:c,category:b}}return null}function i(){return f().flatMap(a=>a.products.map(b=>({categorySlug:a.slug,productId:b.id})))}a.s(["getCategories",()=>f,"getCategoryBySlug",()=>g,"getProductById",()=>h,"getProductPaths",()=>i])},8054,a=>{"use strict";var b=a.i(7669);let c=()=>[];function d(){let[a,d]=(0,b.useState)(c);(0,b.useEffect)(()=>{},[a]);let e=(0,b.useMemo)(()=>a.reduce((a,b)=>a+(b.quantity||0),0),[a]),f=(0,b.useMemo)(()=>a.reduce((a,b)=>Number.isFinite(b.price)?a+b.quantity*b.price:a,0),[a]),g=(0,b.useMemo)(()=>a.some(a=>"on-order"===a.stock),[a]);return{cart:a,addItem:a=>{d(b=>b.findIndex(b=>b.id===a.id)>=0?b.map(b=>b.id===a.id?{...b,quantity:b.quantity+a.quantity}:b):[...b,a])},updateQuantity:(a,b)=>{d(c=>c.map(c=>c.id===a?{...c,quantity:Math.max(1,b)}:c).filter(a=>a.quantity>0))},removeItem:a=>{d(b=>b.filter(b=>b.id!==a))},count:e,total:f,resetCart:()=>d([]),hasOnOrderItem:g}}a.s(["default",()=>d])},6427,a=>{"use strict";var b=a.i(9168),c=a.i(7068),d=a.i(2759),e=a.i(3590),f=a.i(7342),g=a.i(8171),h=a.i(1257),i=a.i(7669),j=a.i(8054),k=a.i(7502);let l=new Intl.NumberFormat("fr-TN",{style:"currency",currency:"TND"}),m=a=>Number.isFinite(a)?l.format(a):`${a||0} TND`;async function n(){return{paths:(0,k.getCategories)().map(a=>({params:{categorySlug:a.slug}})),fallback:!1}}async function o({params:a}){let b=(0,k.getCategoryBySlug)(a.categorySlug);return b?{props:{category:b}}:{notFound:!0}}let p={in:"In stock",out:"Out of stock","on-order":"On order"};function q({category:a}){let[b,c]=(0,i.useState)(""),[d,e]=(0,i.useState)(""),[f,k]=(0,i.useState)(!1),[l,n]=(0,i.useState)({message:"",type:""}),[o,q]=(0,i.useState)(!1),[r,s]=(0,i.useState)({name:"",phone:"",address:"",notes:""}),{cart:t,addItem:u,updateQuantity:v,removeItem:w,total:x,count:y,hasOnOrderItem:z}=(0,j.default)(),A=(0,i.useMemo)(()=>Array.from(new Set(a.products.map(a=>a.brand).filter(Boolean))).sort(),[a.products]),B=(0,i.useMemo)(()=>{let c=d.trim().toLowerCase();return a.products.filter(a=>(!b||a.brand===b)&&(!c||`${a.title} ${a.description} ${a.brand}`.toLowerCase().includes(c)))},[a.products,b,d]),C=B.length?B:a.products,D=a=>{let{name:b,value:c}=a.target;s(a=>({...a,[b]:c}))},E=async a=>{if(a.preventDefault(),!t.length)return void n({message:"Cart is empty",type:"error"});if(!r.name||!r.phone||!r.address)return void n({message:"Name, phone, and address are required.",type:"error"});q(!0),n({message:"Sending order…",type:""});let b={customer:r,items:t.map(a=>({id:a.id,title:a.title,price:a.price,quantity:a.quantity,image:a.image,category:a.category,variantLabel:a.variantLabel})),total:x,currency:"TND"};try{let a=await fetch("/api/create-order",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(b)}),c=await a.json();if(!a.ok||!c.ok)throw Error(c.error||"Unable to place order");s({name:"",phone:"",address:"",notes:""}),n({message:"Order submitted! We will confirm shortly.",type:"success"})}catch(a){console.error("[order] submit failed",a),n({message:a.message||"Unable to submit order.",type:"error"})}finally{q(!1)}},F=()=>k(!1);return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)("main",{className:"max-w-7xl mx-auto px-6 py-12",children:[(0,g.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-3 mb-6",children:[(0,g.jsxs)("nav",{className:"text-sm text-gray-500",id:"breadcrumb",children:[(0,g.jsx)(h.default,{href:"/products",className:"hover:underline",children:"Catalog"}),(0,g.jsx)("span",{className:"mx-1",children:"/"}),(0,g.jsx)("span",{className:"text-gray-700 font-medium",children:a.name})]}),(0,g.jsxs)("div",{className:"flex items-center gap-3 flex-wrap",children:[(0,g.jsxs)("select",{className:"px-3 py-2 rounded-lg border focus:ring-2 focus:ring-blue-200",value:b,onChange:a=>c(a.target.value),children:[(0,g.jsx)("option",{value:"",children:"All brands"}),A.map(a=>(0,g.jsx)("option",{value:a,children:a},a))]}),(0,g.jsx)("input",{type:"search",value:d,onChange:a=>e(a.target.value),placeholder:"Search products...",className:"px-3 py-2 rounded-lg border focus:ring-2 focus:ring-blue-200"}),(0,g.jsx)("button",{type:"button",className:"px-3 py-2 rounded-lg border hover:bg-gray-100",onClick:()=>{c(""),e("")},children:"Reset filters"})]})]}),(0,g.jsx)("div",{className:"grid sm:grid-cols-2 lg:grid-cols-3 gap-6",children:C.map(b=>(0,g.jsxs)("article",{className:`product-card ${"out"===b.stock?"product-out":""}`,"data-tilt":!0,children:[(0,g.jsx)(h.default,{href:`/products/${a.slug}/${b.id}`,className:"block","aria-label":`View ${b.title}`,children:(0,g.jsx)("img",{src:b.image,alt:b.title,className:"card-img"})}),(0,g.jsxs)("div",{className:"p-6 flex flex-col gap-3",children:[(0,g.jsxs)("div",{className:"flex items-center justify-between",children:[(0,g.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:b.title}),(0,g.jsx)("span",{className:"text-xs text-gray-500 uppercase",children:b.brand})]}),(0,g.jsx)("p",{className:"product-description",children:b.description}),(0,g.jsxs)("div",{className:"product-price-row",children:[(0,g.jsx)("span",{className:"product-price",children:m(b.price)}),(0,g.jsx)("span",{className:`stock-badge ${"in"===b.stock?"stock-badge--in":"on-order"===b.stock?"stock-badge--order":"stock-badge--out"}`,children:p[b.stock]||"Unknown"})]}),(0,g.jsx)("div",{className:"flex gap-2 flex-wrap",children:b.usage.map(a=>(0,g.jsx)("span",{className:"tag px-3 py-1 rounded-full text-xs",children:a},`${b.id}-${a}`))}),(0,g.jsxs)("div",{className:"product-actions mt-auto",children:[(0,g.jsx)(h.default,{href:`/products/${a.slug}/${b.id}`,className:"product-detail-btn",children:"View details"}),(0,g.jsx)("button",{type:"button",className:"cart-submit px-4 py-2 text-sm",onClick:()=>((a,b)=>{if(!a)return;let c=b?.price??a.price??0,d=b?.label;u({id:d?`${a.id}-${d}`:a.id,title:a.title,price:c,quantity:1,image:a.image,category:a.categoryName,brand:a.brand,variantLabel:d,stock:a.stock}),k(!0)})(b,b.variants[0]),disabled:"in"!==b.stock,children:"Add to cart"})]})]})]},b.id))})]}),(0,g.jsxs)("button",{id:"cartFab",className:"cart-fab",type:"button",onClick:()=>{k(!0),n({message:"",type:""})},children:[(0,g.jsx)("span",{children:"Cart"}),(0,g.jsx)("span",{className:"px-2 py-1 rounded-full bg-white/15 text-sm font-semibold",children:y})]}),(0,g.jsx)("div",{id:"cartOverlay",className:`cart-overlay ${f?"active":""}`,onClick:F}),(0,g.jsxs)("aside",{id:"cartDrawer",className:`cart-drawer ${f?"open":""}`,"aria-hidden":!f,children:[(0,g.jsxs)("div",{className:"cart-header",children:[(0,g.jsxs)("div",{children:[(0,g.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Your order"}),(0,g.jsx)("p",{className:"text-sm text-gray-500",children:"Review items then confirm your details."})]}),(0,g.jsx)("button",{id:"cartClose",type:"button","aria-label":"Close cart",className:"text-2xl leading-none text-gray-500 hover:text-gray-800",onClick:F,children:"×"})]}),(0,g.jsx)("div",{className:"cart-body",id:"cartItems",children:t.length?t.map(a=>(0,g.jsxs)("div",{className:"cart-item","data-id":a.id,children:[(0,g.jsx)("img",{src:a.image,alt:a.title}),(0,g.jsxs)("div",{children:[(0,g.jsx)("p",{className:"cart-item-title",children:a.title}),(0,g.jsx)("p",{className:"text-xs text-gray-500",children:a.variantLabel?a.variantLabel:a.category}),(0,g.jsxs)("div",{className:"cart-qty mt-2",children:[(0,g.jsx)("button",{type:"button",onClick:()=>v(a.id,a.quantity-1),children:"−"}),(0,g.jsx)("input",{type:"number",min:"1",value:a.quantity,onChange:b=>{let c=Number(b.target.value);Number.isFinite(c)&&v(a.id,c)}}),(0,g.jsx)("button",{type:"button",onClick:()=>v(a.id,a.quantity+1),children:"+"}),(0,g.jsx)("button",{type:"button",onClick:()=>w(a.id),className:"text-xs text-red-500 ml-3",children:"Remove"})]})]})]},a.id)):(0,g.jsx)("p",{className:"empty-cart",children:"Your cart is empty."})}),(0,g.jsxs)("div",{className:"cart-summary",children:[(0,g.jsxs)("div",{className:"cart-summary-row",children:[(0,g.jsx)("span",{children:"Total"}),(0,g.jsx)("span",{children:m(x)})]}),z&&(0,g.jsx)("p",{className:"text-xs text-orange-500 mt-2",children:"Delivery may take longer for on-order items."}),(0,g.jsx)("p",{className:`cart-alert ${l.type}`,role:"status",children:l.message})]}),(0,g.jsxs)("form",{id:"checkoutForm",className:"cart-form",onSubmit:E,noValidate:!0,children:[(0,g.jsxs)("label",{children:[(0,g.jsx)("span",{children:"Full name"}),(0,g.jsx)("input",{type:"text",name:"name",value:r.name,onChange:D,required:!0})]}),(0,g.jsxs)("label",{children:[(0,g.jsx)("span",{children:"Phone"}),(0,g.jsx)("input",{type:"tel",name:"phone",value:r.phone,onChange:D,required:!0})]}),(0,g.jsxs)("label",{children:[(0,g.jsx)("span",{children:"Delivery address"}),(0,g.jsx)("textarea",{name:"address",rows:"2",value:r.address,onChange:D,required:!0})]}),(0,g.jsxs)("label",{children:[(0,g.jsx)("span",{children:"Notes (optional)"}),(0,g.jsx)("textarea",{name:"notes",rows:"2",value:r.notes,onChange:D})]}),(0,g.jsx)("button",{id:"cartSubmitBtn",type:"submit",className:"cart-submit",disabled:o,children:o?"Sending…":"Send order"})]})]})]})}a.s(["default",()=>q,"getStaticPaths",()=>n,"getStaticProps",()=>o],3269);var r=a.i(3269),s=a.i(9193);let t=(0,d.hoist)(r,"default"),u=(0,d.hoist)(r,"getStaticProps"),v=(0,d.hoist)(r,"getStaticPaths"),w=(0,d.hoist)(r,"getServerSideProps"),x=(0,d.hoist)(r,"config"),y=(0,d.hoist)(r,"reportWebVitals"),z=(0,d.hoist)(r,"unstable_getStaticProps"),A=(0,d.hoist)(r,"unstable_getStaticPaths"),B=(0,d.hoist)(r,"unstable_getStaticParams"),C=(0,d.hoist)(r,"unstable_getServerProps"),D=(0,d.hoist)(r,"unstable_getServerSideProps"),E=new b.PagesRouteModule({definition:{kind:c.RouteKind.PAGES,page:"/products/[categorySlug]/index",pathname:"/products/[categorySlug]",bundlePath:"",filename:""},distDir:".next",relativeProjectDir:"",components:{App:f.default,Document:e.default},userland:r}),F=(0,s.getHandler)({srcPage:"/products/[categorySlug]/index",config:x,userland:r,routeModule:E,getStaticPaths:v,getStaticProps:u,getServerSideProps:w});a.s(["config",0,x,"default",0,t,"getServerSideProps",0,w,"getStaticPaths",0,v,"getStaticProps",0,u,"handler",0,F,"reportWebVitals",0,y,"routeModule",0,E,"unstable_getServerProps",0,C,"unstable_getServerSideProps",0,D,"unstable_getStaticParams",0,B,"unstable_getStaticPaths",0,A,"unstable_getStaticProps",0,z],6427)}];

//# sourceMappingURL=_0bda15d3._.js.map