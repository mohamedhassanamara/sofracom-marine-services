module.exports=[2734,(e,t,r)=>{t.exports=e.x("fs",()=>require("fs"))},406,(e,t,r)=>{t.exports=e.x("next/dist/compiled/@opentelemetry/api",()=>require("next/dist/compiled/@opentelemetry/api"))},4747,(e,t,r)=>{t.exports=e.x("path",()=>require("path"))},4799,(e,t,r)=>{t.exports=e.x("crypto",()=>require("crypto"))},2897,(e,t,r)=>{let{randomUUID:a}=e.r(4799),{getFirebaseApp:o}=e.r(1995);async function i(e){return e.body&&"object"==typeof e.body?e.body:new Promise((t,r)=>{let a="";e.on("data",t=>{(a+=t.toString()).length>5e5&&(r(Error("Payload too large")),e.destroy())}),e.on("end",()=>{try{t(a?JSON.parse(a):{})}catch{r(Error("Invalid JSON payload"))}}),e.on("error",r)})}t.exports=async function(e,t){var r;let s,n;if(t.setHeader("Content-Type","application/json"),t.setHeader("Access-Control-Allow-Origin","*"),t.setHeader("Access-Control-Allow-Methods","POST, OPTIONS"),t.setHeader("Access-Control-Allow-Headers","Content-Type"),"OPTIONS"===e.method)return void t.status(204).end();if("POST"!==e.method){t.setHeader("Allow","POST, OPTIONS"),t.status(405).json({ok:!1,error:"Method not allowed"});return}try{s=await i(e)}catch(e){t.status(400).json({ok:!1,error:e.message});return}let l=(n=[],(r=s)&&"object"==typeof r?((!r.name||String(r.name).trim().length<2)&&n.push("Name is required"),r.email&&!(String(r.email).trim().length<5)&&r.email.includes("@")||n.push("Valid email is required"),(!r.details||String(r.details).trim().length<10)&&n.push("Tell us more about your project"),n):["Missing request body"]);if(l.length)return void t.status(400).json({ok:!1,error:l.join(", ")});let d=a(),u={id:d,created_at:new Date().toISOString(),customer_name:s.name.trim(),customer_email:s.email.trim(),customer_phone:(s.phone||"").trim(),subject:(s.subject||"").trim(),details:s.details.trim(),project_type:s.project_type||"general",status:"new"};try{let e=o().firestore();await e.collection("quotes").doc(d).set(u);try{let e=o().messaging(),t=u.details.length>100?`${u.details.slice(0,100)}â€¦`:u.details;await e.send({topic:"sofracom-quotes",notification:{title:`New quote from ${u.customer_name}`,body:t||"Project request received"},data:{quoteId:d,customerName:u.customer_name,subject:u.subject||"Project request"}})}catch(e){console.warn("[quote] FCM notify failed",e)}t.status(200).json({ok:!0,quoteId:d})}catch(e){console.error("[quote] persistence failed",e),t.status(500).json({ok:!1,error:e.message||"Unable to store quote"})}}},391,e=>{"use strict";var t=e.i(6747),r=e.i(9245),a=e.i(4898),o=e.i(2950),i=e.i(2897),s=e.i(7031),n=e.i(1927),l=e.i(6432);let d=(0,o.hoist)(i,"default"),u=(0,o.hoist)(i,"config"),c=new a.PagesAPIRouteModule({definition:{kind:r.RouteKind.PAGES_API,page:"/api/create-quote",pathname:"/api/create-quote",bundlePath:"",filename:""},userland:i,distDir:".next",relativeProjectDir:""});async function p(e,r,a){c.isDev&&(0,l.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let o="/api/create-quote";o=o.replace(/\/index$/,"")||"/";let i=await c.prepare(e,r,{srcPage:o});if(!i){r.statusCode=400,r.end("Bad Request"),null==a.waitUntil||a.waitUntil.call(a,Promise.resolve());return}let{query:d,params:u,prerenderManifest:p,routerServerContext:m}=i;try{let t=e.method||"GET",a=(0,s.getTracer)(),i=a.getActiveScopeSpan(),l=c.instrumentationOnRequestError.bind(c),h=async i=>c.render(e,r,{query:{...d,...u},params:u,allowedRevalidateHeaderKeys:[],multiZoneDraftMode:!1,trustHostHeader:!1,previewProps:p.preview,propagateError:!1,dev:c.isDev,page:"/api/create-quote",internalRevalidate:null==m?void 0:m.revalidate,onError:(...t)=>l(e,...t)}).finally(()=>{if(!i)return;i.setAttributes({"http.status_code":r.statusCode,"next.rsc":!1});let e=a.getRootSpanAttributes();if(!e)return;if(e.get("next.span_type")!==n.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${e.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let s=e.get("next.route");if(s){let e=`${t} ${s}`;i.setAttributes({"next.route":s,"http.route":s,"next.span_name":e}),i.updateName(e)}else i.updateName(`${t} ${o}`)});i?await h(i):await a.withPropagatedContext(e.headers,()=>a.trace(n.BaseServerSpan.handleRequest,{spanName:`${t} ${o}`,kind:s.SpanKind.SERVER,attributes:{"http.method":t,"http.target":e.url}},h))}catch(e){if(c.isDev)throw e;(0,t.sendError)(r,500,"Internal Server Error")}finally{null==a.waitUntil||a.waitUntil.call(a,Promise.resolve())}}e.s(["config",0,u,"default",0,d,"handler",()=>p])}];

//# sourceMappingURL=%5Broot-of-the-server%5D__67a808ac._.js.map